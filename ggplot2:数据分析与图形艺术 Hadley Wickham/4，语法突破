#4,语法突破####
#4.1简介####
#本 章主要介绍ggplot2的基本语法，即图形图层语法
#发动机的尺寸和燃油之间的关系时如何的？我们可以绘制一个发动机耗油
#量和高速公路每加仑行驶的英里数的箱线图，图中颜色由气缸数决定
ggplot(mpg,aes(displ,hwy,colour=factor(cyl)))+
  geom_point()
#这样的图很容易创建，但是我们应该知道这背后的原理

#4.2.1图形属性和数据的映射
#对于散点图，而言它是由每个点组成的，然后对于一个点，它有横坐标，纵坐标
#点的大小和颜色等等，这些都是图形属性，每个图形属性都可以映射为一个变量，‘
#并且设定为一个常数
#比如
#      ggplot(mpg,aes(displ,hwy,colour=factor(cyl)))+
#        geom_point()
#displ控制点的水平位置，hwy控制点的竖直位置，cyl则是控制点的颜色，而点
#的大小和形状都是使用默认值
#对于该数据集，用折线图或者是条形图表示是没有意义的

ggplot(mpg,aes(displ,hwy,colour=factor(cyl)))+
  geom_line()+theme(legend.position = "none")

ggplot(mpg,aes(displ,hwy,colour=factor(cyl)))+
  geom_bar(stat = "identity",position = "identity",fill=NA)+
  theme(legend.position = "none")
#point,line,bar都是几何对象的具体形式，被称作geom
#更复杂的图形一般没有特定的名称，我们不得不去描述一下，以下在散点图的
#基础上对每个组添加了回归线
ggplot(mpg,aes(displ,hwy,colour=factor(cyl)))+
  geom_point()+
  geom_smooth(method="lm")
#4.2.2标度变换####
#数据表中的数据对于电脑而言是没有任何意义的，我们需要把它们从数据单位
#（如升，英里每加仑和气缸数）转换成电脑可以识别的物理单位（如像素和颜色）
#颜色由六个字母组成的十六进制字符表示，大小和形状分别用数字和整数来表示
#用R可以识别图形的属性值
vignette("ggplot2-specs")

#4.3 更复杂的图形示例####
ggplot(mpg,aes(displ,hwy))+
  geom_point()+
  geom_smooth()+
  facet_wrap(~year)
#在这里我们添加了更为复杂的三种新的组件：分面，多个图层和统计量
#分面和图层将原数据切割成多个小数据集，即每个图层的每个分层都含有一个数据
#小数据集，可以想象为一个三维矩阵；分面面板构成了一个二维网络，图层在
#第三维的方向上叠加

#4.4 图层语法的组件####
#由上例可知我们将一个平滑曲线层添加到一个散点图层上
#图层语法所定义的图由以下几个部分组成：
#1，一个默认的数据集和一组从变量到图形属性的映射
#2，一个或者多个图层，每一个都由一种几何对象，一种统计变换和一种位置调整组成，另外数据集和图形属性映射也是可选的
#3，标度，每个图形属性映射都对映一个标度
#4，一个坐标系统
#5，分面设定

#4.4.1 图层####
#图层的作用是生成图像上可以被人感知的对象，一个图层由五部分组成
#1，数据
#2，图形属性映射
#3，一种统计变换（stat）
#4，一种几何对象（geom）
#5，一种位置调整的方式

#4.4.2标度####
#标度控制数据到图形属性的映射，并且图形上所用的每一个图形都代表着一个
#标度。每个标度都作用于图形中的所有数据，以确保数据到图形属性映射的一致性
#4.4.3坐标系####
#笛卡尔，半对数，极坐标
#4.4.4分面####
#分面是条件绘图和栅格绘图的一般形式，通过它可以方便展示数据的不同子集
#特别是在验证在不同条件下模型是否保持一致时，分面绘图是一个非常强大的工具
